#
# @lc app=leetcode.cn id=503 lang=python3
# @lcpr version=30203
#
# [503] ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  II
#

# @lc code=start
class Solution:
    """
    åŒºåˆ«æ˜¯å¾ªç¯æ•°ç»„
    èµ°ä¸¤é
    """
    def nextGreaterElements(self, nums: List[int]) -> List[int]:
        n = len(nums)
        st= []
        res = [-1] * n
        for i in range(2 * n):
            cur = nums[i % n]
            while st and cur > nums[st[-1]%n]:
                idx = st.pop()
                res[idx % n] = cur
            st.append(i)
        return res
    
    """
    å¯ä»¥ä¼˜åŒ–ç‚¹ï¼š
    ç¬¬äºŒåœˆæ—¶ï¼Œä¸å†æ›´æ–°æ ˆï¼Œ
    """
    def nextGreaterElements(self, nums: List[int]) -> List[int]:
        n = len(nums)
        res = [-1] * n
        st = []
        for i in range(2 * n):  # èµ°ä¸¤åœˆ
            cur = nums[i % n]
            # æ ˆå†…å­˜åŸå§‹ä¸‹æ ‡
            while st and nums[st[-1]] < cur:
                res[st.pop()] = cur
            # ç¬¬äºŒåœˆä¸å†å…¥æ ˆï¼ˆé¿å…é‡å¤ï¼‰
            if i < n:
                st.append(i)
        return res
    """
    ç¬¬ä¸€åœˆï¼š
        5 4 3 2 1 5 4 3 2 1
        [5 4 3 2 1]          stack
    ç¬¬äºŒåœˆ ä¸åŠ ï¼š
        5 4 3 2 1 5 4 3 2 1
                    â†‘
        [-1 5 5 5 5           res

        5                   stack

    --------------------------------
        5 4 3 2 1 5 4 3 2 1
                    â†‘
        [-1 5 5 5 5           res
        5                   stack


    ç¬¬äºŒåœˆ åŠ ï¼š
        5 4 3 2 1 5 4 3 2 1
                    â†‘
        [-1 5 5 5 5           res
        5 5                 stack
    
    --------------------------------
        5 4 3 2 1 5 4 3 2 1
                    â†‘
        [-1 5 5 5 5           res
        5 5 4               stack

    """

"""
A. ä¸ºä»€ä¹ˆæ­£åºç¬¬äºŒåœˆä¸å…¥æ ˆï¼Ÿ
æ­£åºæ¨¡æ¿ï¼ˆæ ˆé‡Œè£… å¾…åŒ¹é…çš„åŸå§‹ä¸‹æ ‡ï¼‰çš„ç›®çš„ï¼š
    ç¬¬ 1 åœˆï¼šç™»è®°â€œè¿˜æ²¡æ‰¾åˆ°æ›´å¤§å€¼â€çš„ä¸‹æ ‡ï¼›
    ç¬¬ 2 åœˆï¼šåªè´Ÿè´£å¸®è¿™äº›ä¸‹æ ‡å»â€œçœ‹åˆ°â€å¼€å¤´é‚£æ®µï¼›ä¸å†ç™»è®°ï¼ˆå¦åˆ™é‡å¤ç™»è®°ã€å¾’å¢ç©ºé—´ï¼Œç”šè‡³é‡å¤è¦†ç›–ç­”æ¡ˆï¼‰ã€‚

    ä¾‹å­ A1ï¼šå…¨é™åº
        nums = [5,4,3,2,1]ï¼Œç­”æ¡ˆåº”æ˜¯ [-1,5,5,5,5]
        ç¬¬ 1 åœˆç»“æŸæ—¶ï¼Œé™¤äº† 0ï¼ˆå€¼ 5ï¼‰éƒ½è¿˜æ²¡æ‰¾åˆ°æ›´å¤§ï¼Œæ ˆé‡Œä¼šæœ‰ä¸€å †ä¸‹æ ‡ã€‚
        ç¬¬ 2 åœˆåªæ˜¯è®©è¿™äº›ä¸‹æ ‡â€œçœ‹åˆ°â€å¼€å¤´çš„ 5ï¼Œä»è€Œè¢«é€ä¸ªå¼¹å‡ºå¹¶å†™å…¥ 5ã€‚
        å¦‚æœç¬¬äºŒåœˆè¿˜å…¥æ ˆï¼Œä¼šæŠŠ 0ã€1ã€2â€¦åˆå¡è¿›æ¥ï¼Œæ—¢é‡å¤ç™»è®°ï¼Œåˆå¯èƒ½åå¤è¦†ç›–ï¼ˆå†™å¯¹äº†å†è¢«å†™ä¸€æ¬¡ï¼‰ï¼Œå¾’å¢å¤æ‚åº¦ã€‚

B. ä¸ºä»€ä¹ˆå€’åºä¸¤åœˆéƒ½è¦å…¥æ ˆï¼Ÿ
    å€’åºå¸¸ç”¨çš„æ˜¯â€œå€¼æ ˆâ€å†™æ³•ï¼ˆä¸æ˜¯ä¸‹æ ‡æ ˆï¼‰ï¼š
    æ ˆé‡Œä¿å­˜â€œä»å³ä¾§çœ‹è§çš„å€™é€‰æ›´å¤§å€¼â€ï¼ˆä¸æ˜¯å¾…åŒ¹é…çš„ä¸‹æ ‡ï¼‰ï¼Œ
    æ¯èµ°ä¸€æ­¥å…ˆæŠŠâ€œä¸å¯èƒ½æˆä¸ºæ›´å¤§å€¼â€çš„å…ƒç´ ï¼ˆâ‰¤ å½“å‰å€¼ï¼‰å¼¹æ‰ï¼Œ
    æ­¤æ—¶æ ˆé¡¶å°±æ˜¯â€œå³ä¾§ç¬¬ä¸€ä¸ªæ›´å¤§å€¼â€ã€‚
    ä¸ºäº†ä¿è¯â€œå³ä¾§è§†é‡â€å®Œæ•´ï¼Œä½ æ¯ä¸ª i éƒ½è¦æŠŠå½“å‰å€¼å‹è¿›æ ˆï¼ˆç»™â€œæ›´å·¦è¾¹â€çš„äººå½“å€™é€‰ï¼‰ã€‚è¿™å°±æ„å‘³ç€ä¸¤åœˆéƒ½è¦å…¥æ ˆã€‚
    ä½†åªåœ¨ç¬¬ä¸€åœˆï¼ˆi < nï¼‰å†™ç­”æ¡ˆï¼Œç¬¬äºŒåœˆåªæ˜¯ä¸ºäº†æŠŠâ€œå³ä¾§å€™é€‰é›†åˆâ€é“ºæ»¡ã€‚
"""


class Solution:
    def nextGreaterElements(self, nums: List[int]) -> List[int]:
        n = len(nums)
        res = [-1] * n
        st = []
        # å€’åº
        for i in range(2 * n - 1, -1, -1):
            cur = nums[i % n]
            while st and cur >= st[-1]:
                st.pop()
            res[i % n] = -1 if not st else st[-1]
            """
            å€’åºä¸èƒ½è¿™æ ·äº†ï¼Œå› ä¸ºå­˜çš„æ˜¯å€™é€‰å€¼ï¼Œç¬¬äºŒéæ—¶å€™æ ˆç©ºäº†ï¼Œä¼šå†™å…¥å¾ˆå¤š-1
            Output (0 ms)	 Expected Answer
            [-1,-1,2]	     [2,-1,2]
            [-1,-1,-1,-1,4]	 [2,3,4,-1,4]
            """
            # if i >= n:
            st.append(cur)
        return res

# å€’åºå€¼æ ˆçš„æ­£ç¡®å†™æ³•ï¼ˆå¹¶è§£é‡Šâ€œä¸¥æ ¼å¤§äºâ€
"""
ç¬¬ä¸€éèµ°å®Œè¦ç»´æŠ¤stackä»å¤§åˆ°å°çš„çŠ¶æ€ï¼Œç›¸å½“äºå¤šä¸ªå€™é€‰ç›®æ ‡ï¼Œå¦‚æœåªå–maxï¼Œæƒ³åˆ°äºåªç•™äº†ä¸€ä¸ªæœ€å¤§çš„ï¼Œåé¢çš„å…¨ä¸¢äº†

ğŸ” ç±»æ¯”å½¢è±¡ç‰ˆï¼šã€Œçœ‹å±±æ¨¡å‹ã€
    æŠŠ nums æƒ³è±¡æˆä¸€æ’å±±çš„é«˜åº¦ï¼Œä»å³å¾€å·¦çœ‹ï¼š
    æ ˆé‡Œæ˜¯â€œä½ å³è¾¹æ‰€æœ‰èƒ½çœ‹åˆ°çš„å±±â€ï¼ŒæŒ‰é«˜åº¦é€’å‡æ’ã€‚
    æ–°æ¥çš„å±±ï¼ˆå½“å‰å€¼ï¼‰ä¼šï¼š
    çœ‹çœ‹å³è¾¹æœ‰æ²¡æœ‰æ¯”è‡ªå·±ä½çš„å±± â†’ é‚£äº›è¢«æŒ¡ä½ï¼›
    ç•™ä¸‹æ¯”è‡ªå·±é«˜çš„å±± â†’ é‚£æ˜¯ä½ èƒ½çœ‹åˆ°çš„ç¬¬ä¸€ä¸ªæ›´å¤§å±±ã€‚
"""
class Solution: 
    def nextGreaterElements(self, nums):
        n = len(nums)
        res = [-1] * n
        st = []

        for i in range(2 * n - 1, -1, -1):
            cur = nums[i % n]
            while st and st[-1] <= cur:
                st.pop()
            if i < n:  # åªåœ¨ç¬¬ä¸€åœˆå†™ç­”æ¡ˆ
                res[i] = st[-1] if st else -1
            # ä¸¤åœˆéƒ½è¦å…¥æ ˆï¼Œä¿è¯æ›´å·¦ä¾§çš„äººèƒ½çœ‹åˆ°å……è¶³çš„å³ä¾§å€™é€‰
            st.append(cur)
        return res

# @lc code=end



#
# @lcpr case=start
# [1,2,1]\n
# @lcpr case=end

# @lcpr case=start
# [1,2,3,4,3]\n
# @lcpr case=end

#

